<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <canvas class="canvas" width="500" height="500"></canvas>
    <script id="vertex-shader" type="x-shader/x-vertex">
        attribute vec4 aPosition;
        uniform mat4 mRotate;
        void main() {
            gl_Position = mRotate * aPosition;
        }
    </script>
    <script id="fragment-shader" type="x-shader/x-fragment">
        void main() {
            gl_FragColor = vec4(1.0, 0.5, 0.0, 1.0);
        }
    </script>
    <script type="module">
        import initShader from '../utils/initShader.js';
        import { mat4 } from '../node_modules/gl-matrix/esm/index.js';
        const canvas = document.querySelector('.canvas');
        const gl = canvas.getContext('webgl');
        const program = initShader(gl);
        const vertices = new Float32Array([
            -0.5, -0.5,
            0.5, -0.5,
            0, 0.5,
        ])
        const buffer = gl.createBuffer();
        gl.bindBuffer(gl.ARRAY_BUFFER, buffer);
        gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);
        
        const aPosition = gl.getAttribLocation(program, 'aPosition');
        gl.vertexAttribPointer(aPosition, 2, gl.FLOAT, false, 0, 0);
        gl.enableVertexAttribArray(aPosition);

        const mRotate = gl.getUniformLocation(program, 'mRotate');
        const matrix = mat4.create(); // 创建一个单位矩阵
        const rad = 45 * Math.PI / 180;
        // mat4.rotate(matrix, matrix, rad, [0, 0, 1]);
        // mat4.fromRotation(matrix, rad, [0, 0, 1]);
        mat4.fromXRotation(matrix, rad);

        gl.uniformMatrix4fv(mRotate, false, matrix);
        gl.drawArrays(gl.TRIANGLES, 0, 3);
    </script>
</body>
</html>